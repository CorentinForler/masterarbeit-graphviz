{"version":3,"file":"cytoscape-leaflet.min.js","sources":["../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/memoize-one/dist/memoize-one.esm.js","../src/utils.ts","../src/mapHandler.ts","../src/index.ts"],"sourcesContent":["function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var safeIsNaN = Number.isNaN ||\n    function ponyfill(value) {\n        return typeof value === 'number' && value !== value;\n    };\nfunction isEqual(first, second) {\n    if (first === second) {\n        return true;\n    }\n    if (safeIsNaN(first) && safeIsNaN(second)) {\n        return true;\n    }\n    return false;\n}\nfunction areInputsEqual(newInputs, lastInputs) {\n    if (newInputs.length !== lastInputs.length) {\n        return false;\n    }\n    for (var i = 0; i < newInputs.length; i++) {\n        if (!isEqual(newInputs[i], lastInputs[i])) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoizeOne(resultFn, isEqual) {\n    if (isEqual === void 0) { isEqual = areInputsEqual; }\n    var cache = null;\n    function memoized() {\n        var newArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            newArgs[_i] = arguments[_i];\n        }\n        if (cache && cache.lastThis === this && isEqual(newArgs, cache.lastArgs)) {\n            return cache.lastResult;\n        }\n        var lastResult = resultFn.apply(this, newArgs);\n        cache = {\n            lastResult: lastResult,\n            lastArgs: newArgs,\n            lastThis: this,\n        };\n        return lastResult;\n    }\n    memoized.clear = function clear() {\n        cache = null;\n    };\n    return memoized;\n}\n\nexport { memoizeOne as default };\n","import memoizeOne from 'memoize-one';\n\n/**\n * @see https://github.com/cytoscape/cytoscape.js/blob/master/src/extensions/renderer/base/load-listeners.js\n */\nexport function isMultSelKeyDown(event: MouseEvent) {\n  return event.shiftKey || event.metaKey || event.ctrlKey; // maybe event.altKey\n}\n\n/**\n * @param {cytoscape.Position} position1\n * @param {cytoscape.Position} position2\n * @return {boolean}\n */\nfunction arePositionsEqual(\n  position1: cytoscape.Position,\n  position2: cytoscape.Position\n) {\n  return position1.x === position2.x && position1.y === position2.y;\n}\n\nexport function getUpdatedPositions(\n  currentPositions: cytoscape.NodePositionMap,\n  positions: cytoscape.NodePositionMap\n): cytoscape.NodePositionMap {\n  return Object.fromEntries(\n    Object.entries(positions).filter(([id, position]) => {\n      const currentPosition = currentPositions[id];\n      return !arePositionsEqual(currentPosition, position);\n    })\n  );\n}\n\nexport const getUpdatedPositionsMemo = memoizeOne(getUpdatedPositions);\n","import L, { PointTuple } from 'leaflet';\nimport { MapHandlerOptions } from './types';\nimport { getUpdatedPositionsMemo, isMultSelKeyDown } from './utils';\n\nconst DEFAULT_FIT_PADDING: PointTuple = [50, 50];\nconst DEFAULT_ANIMATION_DURATION = 1;\nconst HIDDEN_CLASS = 'cytoscape-map__hidden';\n\nexport class MapHandler {\n  cy: cytoscape.Core | undefined;\n  mapOptions: L.MapOptions;\n  options: MapHandlerOptions | undefined;\n\n  mapContainer: HTMLElement | undefined;\n  map: L.Map | undefined;\n\n  originalAutoungrabify: boolean | undefined;\n  originalUserZoomingEnabled: boolean | undefined;\n  originalUserPanningEnabled: boolean | undefined;\n\n  originalPositions: cytoscape.NodePositionMap | undefined;\n  originalZoom: number | undefined;\n  originalPan: cytoscape.Position | undefined;\n\n  enabled: boolean = false;\n  panning: boolean = false;\n  updateLayout: boolean = true;\n  // zooming: boolean = false;\n\n  requestAnimationId: number | undefined;\n\n  onGraphContainerMouseDownBound = this.onGraphContainerMouseDown.bind(this);\n  onGraphContainerMouseMoveBound = this.onGraphContainerMouseMove.bind(this);\n  onGraphContainerWheelBound = this.onGraphContainerWheel.bind(this);\n  onMapMoveBound = this.onMapMove.bind(this);\n\n  onGraphAddBound = this.onGraphAdd.bind(this);\n  onGraphResizeBound = this.onGraphResize.bind(this);\n  onGraphDragFreeBound = this.onGraphDragFree.bind(this);\n\n  // onZoomStartBound = this.onZoomStart.bind(this);\n  // onZoomEndBound = this.onZoomEnd.bind(this);\n  // panZoomAnimationFrameBound = this.panZoomAnimationFrame.bind(this);\n\n  /**\n   * @param {cytoscape.Core} cy\n   * @param {L.MapOptions} mapOptions\n   * @param {MapHandlerOptions} options\n   */\n  constructor(\n    cy: cytoscape.Core,\n    mapOptions: L.MapOptions,\n    options: MapHandlerOptions\n  ) {\n    this.cy = cy;\n    this.mapOptions = mapOptions;\n    this.options = options;\n\n    this.updateLayout = options.updateLayout || false;\n\n    if (!(typeof this.options.getPosition === 'function')) {\n      throw new Error('getPosition should be a function');\n    }\n    if (\n      this.options.setPosition &&\n      !(typeof this.options.setPosition === 'function')\n    ) {\n      throw new Error('setPosition should be a function');\n    }\n\n    this.enable();\n  }\n\n  enable() {\n    if (!this.cy) return\n    if (!this.options) return\n\n    if (this.enabled) return\n    this.enabled = true;\n\n    // Cytoscape config\n    this.originalAutoungrabify = this.cy.autoungrabify();\n    this.originalUserZoomingEnabled = this.cy.userZoomingEnabled();\n    this.originalUserPanningEnabled = this.cy.userPanningEnabled();\n\n    this.cy.userZoomingEnabled(false);\n    this.cy.userPanningEnabled(false);\n\n    // Cytoscape events\n    const graphContainer = this.cy.container() as unknown as HTMLElement;\n    graphContainer.addEventListener(\n      'mousedown',\n      this.onGraphContainerMouseDownBound\n    );\n    graphContainer.addEventListener(\n      'mousemove',\n      this.onGraphContainerMouseMoveBound\n    );\n    graphContainer.addEventListener('wheel', this.onGraphContainerWheelBound);\n    this.cy.on('add', this.onGraphAddBound);\n    this.cy.on('resize', this.onGraphResizeBound);\n    this.cy.on('dragfree', this.onGraphDragFreeBound);\n\n    // Map container\n    if (!this.mapContainer) {\n      this.mapContainer = document.createElement('div');\n      this.mapContainer.style.position = 'absolute';\n      this.mapContainer.style.top = '0px';\n      this.mapContainer.style.left = '0px';\n      this.mapContainer.style.width = '100%';\n      this.mapContainer.style.height = '100%';\n\n      graphContainer?.prepend(this.mapContainer);\n    }\n\n    // Leaflet instance\n    if (!this.map) {\n      this.map = new L.Map(this.mapContainer, this.mapOptions);\n      this.fit();\n    }\n\n    // Map events\n    this.map.on('move', this.onMapMoveBound);\n    // this.map.on('zoomstart', this.onZoomStartBound);\n    // this.map.on('zoomend', this.onZoomEndBound);\n\n    // Cytoscape unit viewport\n    this.originalZoom = this.cy.zoom();\n    this.originalPan = { ...this.cy.pan() };\n\n    const zoom = 1;\n    const pan = { x: 0, y: 0 };\n\n    if (this.options.animate) {\n      this.cy.animate(\n        {\n          zoom: zoom,\n          pan: pan,\n        },\n        {\n          duration:\n            this.options.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n          easing: 'linear',\n        }\n      );\n    } else {\n      this.cy.viewport({ zoom, pan });\n    }\n\n    // Cytoscape positions\n    this.enableGeographicPositions();\n  }\n\n  destroy() {\n    this.disable();\n\n    // Map instance\n    this.map?.remove();\n    this.map = undefined;\n\n    // Map container\n    this.mapContainer?.remove();\n    this.mapContainer = undefined;\n\n    this.cy = undefined;\n    this.options = undefined;\n  }\n\n  disable() {\n    if (!this.enabled) return\n    this.enabled = false;\n\n    // Cytoscape events\n    const graphContainer = this.cy?.container();\n    if (graphContainer) {\n      graphContainer.removeEventListener(\n        'mousedown',\n        this.onGraphContainerMouseDownBound\n      );\n      graphContainer.removeEventListener(\n        'mousemove',\n        this.onGraphContainerMouseMoveBound\n      );\n      graphContainer.removeEventListener(\n        'wheel',\n        this.onGraphContainerWheelBound\n      );\n    }\n    if (this.cy) {\n      this.cy.off('add', this.onGraphAddBound);\n      this.cy.off('resize', this.onGraphResizeBound);\n      this.cy.off('dragfree', this.onGraphDragFreeBound);\n\n      // Cytoscape config\n      this.cy.autoungrabify(this.originalAutoungrabify);\n      this.cy.userZoomingEnabled(this.originalUserZoomingEnabled);\n      this.cy.userPanningEnabled(this.originalUserPanningEnabled);\n    }\n    this.originalAutoungrabify = undefined;\n    this.originalUserZoomingEnabled = undefined;\n    this.originalUserPanningEnabled = undefined;\n\n    // Map events\n    this.map?.off('move', this.onMapMoveBound);\n\n    // Cytoscape unit viewport\n    if (this.options?.animate) {\n      this.cy?.animate(\n        {\n          zoom: this.originalZoom,\n          pan: this.originalPan,\n        },\n        {\n          duration:\n            this.options.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n          easing: 'linear',\n        }\n      );\n    } else {\n      this.cy?.viewport({\n        zoom: this.originalZoom ?? 5,\n        pan:\n          this.originalPan ??\n          ({\n            x: 0,\n            y: 0,\n          } as cytoscape.Position),\n      });\n    }\n\n    this.originalZoom = undefined;\n    this.originalPan = undefined;\n\n    // Cytoscape positions\n    this.disableGeographicPositions();\n  }\n\n  /**\n   * @param {cytoscape.NodeCollection} nodes\n   * @param {L.FitBoundsOptions} options\n   */\n  fit(\n    nodes: cytoscape.NodeCollection = this.cy?.nodes() ??\n      ([] as unknown as cytoscape.NodeCollection),\n    options: L.FitBoundsOptions = { padding: DEFAULT_FIT_PADDING, animate: false }\n  ) {\n    const bounds = this.getNodeLngLatBounds(nodes);\n    if (!bounds.isValid()) {\n      return;\n    }\n\n    this.map?.fitBounds(bounds, options);\n  }\n\n  /**\n   * @private\n   */\n  private enableGeographicPositions() {\n    if (!this.updateLayout) return;\n\n    const nodes: cytoscape.NodeCollection =\n      this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection);\n\n    this.originalPositions = Object.fromEntries(\n      nodes.map((node) => {\n        return [node.id(), { ...node.position() }];\n      })\n    );\n\n    const positions: cytoscape.NodePositionMap = Object.fromEntries(\n      nodes\n        .map((node) => {\n          return [node.id(), this.getGeographicPosition(node)];\n        })\n        .filter(([_id, position]) => {\n          return !!position;\n        })\n    );\n\n    // hide nodes without position\n    const nodesWithoutPosition = nodes.filter((node) => !positions[node.id()]);\n    nodesWithoutPosition.addClass(HIDDEN_CLASS).style('display', 'none');\n\n    this.cy\n      ?.layout({\n        name: 'preset',\n        positions: positions,\n        fit: false,\n        animate: this.options?.animate,\n        animationDuration:\n          this.options?.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n        animationEasing: 'ease-out-cubic',\n      })\n      .run();\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeCollection | undefined} nodes\n   */\n  private updateGeographicPositions(\n    nodes = this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection)\n  ) {\n    if (!this.updateLayout) return;\n\n    const updatePositions = (\n      nodes = this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection)\n    ) => {\n      const positions: cytoscape.NodePositionMap = Object.fromEntries(\n        nodes\n          .map((node) => {\n            return [node.id(), this.getGeographicPosition(node)];\n          })\n          .filter(([_id, position]) => {\n            return !!position;\n          })\n      );\n\n      // update only positions which have changed, for cytoscape-edgehandles compatibility\n      const currentPositions: cytoscape.NodePositionMap = Object.fromEntries(\n        nodes.map((node) => {\n          return [node.id(), { ...node.position() }];\n        })\n      );\n      const updatedPositions = getUpdatedPositionsMemo(\n        currentPositions,\n        positions\n      );\n\n      // hide nodes without position\n      const nodesWithoutPosition = nodes.filter(\n        (node) => !positions[node.id()]\n      );\n      nodesWithoutPosition.addClass(HIDDEN_CLASS).style('display', 'none');\n\n      // for (const k in updatedPositions) {\n      //   const prev = currentPositions[k];\n      //   const next = updatedPositions[k];\n      //   if (prev && next) {\n      //     this.cy?.getElementById(k)?.position(next);\n      //   }\n      // }\n\n      this.cy\n        ?.layout({\n          name: 'preset',\n          positions: updatedPositions,\n          fit: false,\n        })\n        .run();\n    };\n\n    updatePositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  private disableGeographicPositions() {\n    if (!this.updateLayout) return;\n\n    const nodes =\n      this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection);\n\n    this.cy\n      ?.layout({\n        name: 'preset',\n        positions: this.originalPositions,\n        fit: false,\n        animate: this.options?.animate,\n        animationDuration:\n          this.options?.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n        animationEasing: 'ease-in-cubic',\n        stop: () => {\n          // show nodes without position\n          const nodesWithoutPosition = nodes.filter((node) =>\n            node.hasClass(HIDDEN_CLASS)\n          );\n          nodesWithoutPosition.removeClass(HIDDEN_CLASS).style('display', null);\n        },\n      })\n      .run();\n\n    this.originalPositions = undefined;\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerMouseDown(event: MouseEvent) {\n    // @ts-ignore\n    const renderer = this.cy?.renderer();\n    if (\n      event.buttons === 1 &&\n      !isMultSelKeyDown(event) &&\n      !renderer.hoverData.down\n    ) {\n      // @ts-ignore,\n      if (this.cy) this.cy.renderer().hoverData.dragging = true; // cytoscape-lasso compatibility\n      this.dispatchMapEvent(event);\n\n      document.addEventListener(\n        'mouseup',\n        () => {\n          if (!this.panning) {\n            return;\n          }\n\n          this.panning = false;\n\n          // @ts-ignore, prevent unselecting in Cytoscape mouseup\n          if (this.cy) this.cy.renderer().hoverData.dragged = true;\n        },\n        { once: true }\n      );\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerMouseMove(event: MouseEvent) {\n    // @ts-ignore\n    const renderer = this.cy?.renderer();\n    if (\n      event.buttons === 1 &&\n      !isMultSelKeyDown(event) &&\n      !renderer.hoverData.down\n    ) {\n      this.panning = true;\n\n      this.dispatchMapEvent(event);\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerWheel(event: MouseEvent) {\n    event.preventDefault();\n    this.dispatchMapEvent(event);\n  }\n\n  /**\n   * @private\n   */\n  private onMapMove() {\n    this.updateGeographicPositions();\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.EventObject} event\n   */\n  private onGraphAdd(event: cytoscape.EventObject) {\n    if (!event.target.isNode()) {\n      return;\n    }\n\n    const node: cytoscape.NodeSingular = event.target;\n\n    if (!this.originalPositions) this.originalPositions = {};\n    this.originalPositions[node.id()] = { ...node.position() };\n\n    const nodes = this.cy?.collection().merge(node);\n    this.updateGeographicPositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  private onGraphResize() {\n    this.map?.invalidateSize(false);\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.EventObject} event\n   */\n  private onGraphDragFree(event: cytoscape.EventObject) {\n    const node: cytoscape.NodeSingular = event.target;\n\n    if (this.options?.setPosition) {\n      const { x, y } = node.position();\n      const position: PointTuple = [x, y];\n      const lngLat = this.map?.containerPointToLatLng(position);\n      if (lngLat) this.options.setPosition(node, lngLat);\n    }\n\n    const nodes = this.cy?.collection().merge(node);\n    this.updateGeographicPositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  // private onZoomStart() {\n  //   this.zooming = true;\n  //   this.panZoomAnimationFrame();\n  // }\n\n  /**\n   * @private\n   */\n  // private panZoomAnimationFrame() {\n  //   if (!this.zooming) {\n  //     return window.cancelAnimationFrame(this.requestAnimationId);\n  //   }\n  //   this.updateGeographicPositions()\n  //   this.requestAnimationId = window.requestAnimationFrame(this.panZoomAnimationFrameBound);\n  // }\n\n  /**\n   * @private\n   */\n  // private onZoomEnd() {\n  //   window.cancelAnimationFrame(this.requestAnimationId);\n  //   this.zooming = false;\n  // }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private dispatchMapEvent(event: MouseEvent) {\n    if (\n      event.target === this.mapContainer ||\n      // @ts-ignore\n      this.mapContainer?.contains(event.target)\n    ) {\n      return;\n    }\n\n    // @ts-ignore\n    const clonedEvent = new event.constructor(event.type, event);\n    this.map?.getContainer().dispatchEvent(clonedEvent);\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeSingular} node\n   * @return {L.LatLng | undefined}\n   */\n  private getNodeLngLat(node: cytoscape.NodeSingular): L.LatLng | undefined {\n    if (typeof this.options?.getPosition !== 'function') return;\n\n    const lngLatLike = this.options?.getPosition(node);\n    if (!lngLatLike) {\n      return;\n    }\n\n    let lngLat;\n    try {\n      lngLat = L.latLng(lngLatLike);\n    } catch (e) {\n      return;\n    }\n\n    return lngLat;\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeCollection} nodes\n   * @return {L.LatLngBounds}\n   */\n  private getNodeLngLatBounds(\n    nodes: cytoscape.NodeCollection = this.cy?.nodes() ??\n      ([] as unknown as cytoscape.NodeCollection)\n  ): L.LatLngBounds {\n    return nodes.reduce((bounds, node) => {\n      const lngLat = this.getNodeLngLat(node);\n      if (!lngLat) {\n        return bounds;\n      }\n\n      return bounds.extend(lngLat);\n    }, L.latLngBounds([]));\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeSingular} node\n   * @return {cytoscape.Position | undefined}\n   */\n  private getGeographicPosition(\n    node: cytoscape.NodeSingular\n  ): cytoscape.Position | undefined {\n    const lngLat = this.getNodeLngLat(node);\n    if (!lngLat) {\n      return;\n    }\n\n    return this.map?.latLngToContainerPoint(lngLat);\n  }\n}\n","import L from 'leaflet';\nimport { MapHandler } from './mapHandler';\nimport { Instance, MapHandlerOptions } from './types';\n\nfunction register(cytoscape: Instance) {\n  if (!cytoscape) {\n    return;\n  }\n\n  cytoscape(\n    'core',\n    'L',\n    function (mapConfig: L.MapOptions, config: MapHandlerOptions) {\n      return new MapHandler(\n        // @ts-ignore\n        this,\n        mapConfig,\n        config\n      );\n    }\n  );\n}\n\nif (typeof window.cytoscape !== 'undefined') {\n  register(window.cytoscape);\n}\n\nexport default register;\n"],"names":["module","exports","arr","Array","isArray","__esModule","i","_i","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","push","value","length","err","len","arr2","o","minLen","arrayLikeToArray","n","Object","prototype","toString","slice","constructor","name","from","test","TypeError","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","obj","safeIsNaN","Number","isNaN","areInputsEqual","newInputs","lastInputs","first","second","isMultSelKeyDown","event","shiftKey","metaKey","ctrlKey","getUpdatedPositionsMemo","resultFn","isEqual","cache","memoized","newArgs","arguments","lastThis","this","lastArgs","lastResult","apply","clear","memoizeOne","currentPositions","positions","fromEntries","entries","filter","_ref","position1","position2","_ref2","_slicedToArray","id","position","currentPosition","x","y","DEFAULT_FIT_PADDING","HIDDEN_CLASS","MapHandler","cy","mapOptions","options","_classCallCheck","_defineProperty","onGraphContainerMouseDown","bind","onGraphContainerMouseMove","onGraphContainerWheel","onMapMove","onGraphAdd","onGraphResize","onGraphDragFree","updateLayout","getPosition","Error","setPosition","enable","_createClass","enabled","originalAutoungrabify","autoungrabify","originalUserZoomingEnabled","userZoomingEnabled","originalUserPanningEnabled","userPanningEnabled","graphContainer","container","addEventListener","onGraphContainerMouseDownBound","onGraphContainerMouseMoveBound","onGraphContainerWheelBound","on","onGraphAddBound","onGraphResizeBound","onGraphDragFreeBound","mapContainer","document","createElement","style","top","left","width","height","prepend","map","L","Map","fit","onMapMoveBound","originalZoom","zoom","originalPan","_objectSpread","pan","_this$options$animati","animate","duration","animationDuration","easing","viewport","enableGeographicPositions","_this$map","_this$mapContainer","disable","remove","undefined","_this$cy","_this$map2","_this$options","_this$cy2","_this$options$animati2","_this$cy3","_this$originalZoom","_this$originalPan","removeEventListener","off","disableGeographicPositions","_this$cy$nodes","_this$cy4","_this$map3","nodes","padding","bounds","getNodeLngLatBounds","isValid","fitBounds","_this$cy$nodes2","_this$cy5","_this$cy6","_this$options2","_this$options$animati3","_this$options3","_this","originalPositions","node","getGeographicPosition","addClass","layout","animationEasing","run","_this$cy$nodes3","_this$cy7","_this2","updatePositions","_this2$cy$nodes","_this2$cy","_this2$cy2","_ref3","_ref4","updatedPositions","nodesWithoutPosition","_this$cy$nodes4","_this$cy8","_this$cy9","_this$options4","_this$options$animati4","_this$options5","stop","hasClass","removeClass","_this$cy10","_this3","renderer","buttons","hoverData","down","dragging","dispatchMapEvent","panning","dragged","once","_this$cy11","preventDefault","updateGeographicPositions","_this$cy12","isNode","collection","merge","_this$map4","invalidateSize","_this$options6","_this$cy13","_this$map5","lngLat","containerPointToLatLng","_this$mapContainer2","_this$map6","contains","clonedEvent","type","getContainer","dispatchEvent","_this$options7","_this$options8","lngLatLike","latLng","e","_this$cy$nodes5","_this$cy14","_this4","reduce","getNodeLngLat","extend","latLngBounds","_this$map7","latLngToContainerPoint","register","cytoscape","mapConfig","config","window"],"mappings":"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"}