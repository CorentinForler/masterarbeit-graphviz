!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],i):(t="undefined"!=typeof globalThis?globalThis:t||self).CytoscapeLeaflet=i(t.L)}(this,(function(t){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=i(t);function o(t,i,n){return t(n={path:i,exports:{},require:function(t,i){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==i&&n.path)}},n.exports),n.exports}var e=o((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),r=o((function(t){t.exports=function(t,i){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,e,r=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(r.push(o.value),!i||r.length!==i);a=!0);}catch(t){s=!0,e=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw e}}return r}},t.exports.__esModule=!0,t.exports.default=t.exports})),a=o((function(t){t.exports=function(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,o=new Array(i);n<i;n++)o[n]=t[n];return o},t.exports.__esModule=!0,t.exports.default=t.exports})),s=o((function(t){t.exports=function(t,i){if(t){if("string"==typeof t)return a(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,i):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),u=o((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),l=o((function(t){t.exports=function(t,i){return e(t)||r(t,i)||s(t,i)||u()},t.exports.__esModule=!0,t.exports.default=t.exports})),d=o((function(t){t.exports=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),h=o((function(t){function i(t,i){for(var n=0;n<i.length;n++){var o=i[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,n,o){return n&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),p=o((function(t){t.exports=function(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports})),c=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function v(t,i){if(t.length!==i.length)return!1;for(var n=0;n<t.length;n++)if(o=t[n],e=i[n],!(o===e||c(o)&&c(e)))return!1;var o,e;return!0}function f(t){return t.shiftKey||t.metaKey||t.ctrlKey}var y=function(t,i){void 0===i&&(i=v);var n=null;function o(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];if(n&&n.lastThis===this&&i(o,n.lastArgs))return n.lastResult;var r=t.apply(this,o);return n={lastResult:r,lastArgs:o,lastThis:this},r}return o.clear=function(){n=null},o}((function(t,i){return Object.fromEntries(Object.entries(i).filter((function(i){var n,o,e=l(i,2),r=e[0],a=e[1],s=t[r];return o=a,!((n=s).x===o.x&&n.y===o.y)})))}));function g(t,i){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);i&&(o=o.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?g(Object(n),!0).forEach((function(i){p(t,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))}))}return t}var b=[50,50],P="cytoscape-map__hidden",x=function(){function t(i,n,o){if(d(this,t),p(this,"cy",void 0),p(this,"mapOptions",void 0),p(this,"options",void 0),p(this,"mapContainer",void 0),p(this,"map",void 0),p(this,"originalAutoungrabify",void 0),p(this,"originalUserZoomingEnabled",void 0),p(this,"originalUserPanningEnabled",void 0),p(this,"originalPositions",void 0),p(this,"originalZoom",void 0),p(this,"originalPan",void 0),p(this,"enabled",!1),p(this,"panning",!1),p(this,"updateLayout",!0),p(this,"requestAnimationId",void 0),p(this,"onGraphContainerMouseDownBound",this.onGraphContainerMouseDown.bind(this)),p(this,"onGraphContainerMouseMoveBound",this.onGraphContainerMouseMove.bind(this)),p(this,"onGraphContainerWheelBound",this.onGraphContainerWheel.bind(this)),p(this,"onMapMoveBound",this.onMapMove.bind(this)),p(this,"onGraphAddBound",this.onGraphAdd.bind(this)),p(this,"onGraphResizeBound",this.onGraphResize.bind(this)),p(this,"onGraphDragFreeBound",this.onGraphDragFree.bind(this)),this.cy=i,this.mapOptions=n,this.options=o,this.updateLayout=o.updateLayout||!1,"function"!=typeof this.options.getPosition)throw new Error("getPosition should be a function");if(this.options.setPosition&&"function"!=typeof this.options.setPosition)throw new Error("setPosition should be a function");this.enable()}return h(t,[{key:"enable",value:function(){if(this.cy&&this.options&&!this.enabled){this.enabled=!0,this.originalAutoungrabify=this.cy.autoungrabify(),this.originalUserZoomingEnabled=this.cy.userZoomingEnabled(),this.originalUserPanningEnabled=this.cy.userPanningEnabled(),this.cy.userZoomingEnabled(!1),this.cy.userPanningEnabled(!1);var t=this.cy.container();t.addEventListener("mousedown",this.onGraphContainerMouseDownBound),t.addEventListener("mousemove",this.onGraphContainerMouseMoveBound),t.addEventListener("wheel",this.onGraphContainerWheelBound),this.cy.on("add",this.onGraphAddBound),this.cy.on("resize",this.onGraphResizeBound),this.cy.on("dragfree",this.onGraphDragFreeBound),this.mapContainer||(this.mapContainer=document.createElement("div"),this.mapContainer.style.position="absolute",this.mapContainer.style.top="0px",this.mapContainer.style.left="0px",this.mapContainer.style.width="100%",this.mapContainer.style.height="100%",null==t||t.prepend(this.mapContainer)),this.map||(this.map=new n.default.Map(this.mapContainer,this.mapOptions),this.fit()),this.map.on("move",this.onMapMoveBound),this.originalZoom=this.cy.zoom(),this.originalPan=m({},this.cy.pan());var i,o={x:0,y:0};if(this.options.animate)this.cy.animate({zoom:1,pan:o},{duration:null!==(i=this.options.animationDuration)&&void 0!==i?i:1,easing:"linear"});else this.cy.viewport({zoom:1,pan:o});this.enableGeographicPositions()}}},{key:"destroy",value:function(){var t,i;this.disable(),null===(t=this.map)||void 0===t||t.remove(),this.map=void 0,null===(i=this.mapContainer)||void 0===i||i.remove(),this.mapContainer=void 0,this.cy=void 0,this.options=void 0}},{key:"disable",value:function(){var t,i,n;if(this.enabled){this.enabled=!1;var o,e,r,a,s,u=null===(t=this.cy)||void 0===t?void 0:t.container();if(u&&(u.removeEventListener("mousedown",this.onGraphContainerMouseDownBound),u.removeEventListener("mousemove",this.onGraphContainerMouseMoveBound),u.removeEventListener("wheel",this.onGraphContainerWheelBound)),this.cy&&(this.cy.off("add",this.onGraphAddBound),this.cy.off("resize",this.onGraphResizeBound),this.cy.off("dragfree",this.onGraphDragFreeBound),this.cy.autoungrabify(this.originalAutoungrabify),this.cy.userZoomingEnabled(this.originalUserZoomingEnabled),this.cy.userPanningEnabled(this.originalUserPanningEnabled)),this.originalAutoungrabify=void 0,this.originalUserZoomingEnabled=void 0,this.originalUserPanningEnabled=void 0,null===(i=this.map)||void 0===i||i.off("move",this.onMapMoveBound),null!==(n=this.options)&&void 0!==n&&n.animate)null===(o=this.cy)||void 0===o||o.animate({zoom:this.originalZoom,pan:this.originalPan},{duration:null!==(e=this.options.animationDuration)&&void 0!==e?e:1,easing:"linear"});else null===(r=this.cy)||void 0===r||r.viewport({zoom:null!==(a=this.originalZoom)&&void 0!==a?a:5,pan:null!==(s=this.originalPan)&&void 0!==s?s:{x:0,y:0}});this.originalZoom=void 0,this.originalPan=void 0,this.disableGeographicPositions()}}},{key:"fit",value:function(){var t,i,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{padding:b,animate:!1},r=this.getNodeLngLatBounds(o);r.isValid()&&(null===(n=this.map)||void 0===n||n.fitBounds(r,e))}},{key:"enableGeographicPositions",value:function(){var t,i,n,o,e,r,a=this;if(this.updateLayout){var s=null!==(t=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[];this.originalPositions=Object.fromEntries(s.map((function(t){return[t.id(),m({},t.position())]})));var u=Object.fromEntries(s.map((function(t){return[t.id(),a.getGeographicPosition(t)]})).filter((function(t){var i=l(t,2);return i[0],!!i[1]})));s.filter((function(t){return!u[t.id()]})).addClass(P).style("display","none"),null===(n=this.cy)||void 0===n||n.layout({name:"preset",positions:u,fit:!1,animate:null===(o=this.options)||void 0===o?void 0:o.animate,animationDuration:null!==(e=null===(r=this.options)||void 0===r?void 0:r.animationDuration)&&void 0!==e?e:1,animationEasing:"ease-out-cubic"}).run()}}},{key:"updateGeographicPositions",value:function(){var t,i,n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[];if(this.updateLayout){var e=function(){var t,i,o,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(i=n.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[],r=Object.fromEntries(e.map((function(t){return[t.id(),n.getGeographicPosition(t)]})).filter((function(t){var i=l(t,2);return i[0],!!i[1]}))),a=Object.fromEntries(e.map((function(t){return[t.id(),m({},t.position())]}))),s=y(a,r),u=e.filter((function(t){return!r[t.id()]}));u.addClass(P).style("display","none"),null===(o=n.cy)||void 0===o||o.layout({name:"preset",positions:s,fit:!1}).run()};e(o)}}},{key:"disableGeographicPositions",value:function(){var t,i,n,o,e,r;if(this.updateLayout){var a=null!==(t=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[];null===(n=this.cy)||void 0===n||n.layout({name:"preset",positions:this.originalPositions,fit:!1,animate:null===(o=this.options)||void 0===o?void 0:o.animate,animationDuration:null!==(e=null===(r=this.options)||void 0===r?void 0:r.animationDuration)&&void 0!==e?e:1,animationEasing:"ease-in-cubic",stop:function(){a.filter((function(t){return t.hasClass(P)})).removeClass(P).style("display",null)}}).run(),this.originalPositions=void 0}}},{key:"onGraphContainerMouseDown",value:function(t){var i,n=this,o=null===(i=this.cy)||void 0===i?void 0:i.renderer();1!==t.buttons||f(t)||o.hoverData.down||(this.cy&&(this.cy.renderer().hoverData.dragging=!0),this.dispatchMapEvent(t),document.addEventListener("mouseup",(function(){n.panning&&(n.panning=!1,n.cy&&(n.cy.renderer().hoverData.dragged=!0))}),{once:!0}))}},{key:"onGraphContainerMouseMove",value:function(t){var i,n=null===(i=this.cy)||void 0===i?void 0:i.renderer();1!==t.buttons||f(t)||n.hoverData.down||(this.panning=!0,this.dispatchMapEvent(t))}},{key:"onGraphContainerWheel",value:function(t){t.preventDefault(),this.dispatchMapEvent(t)}},{key:"onMapMove",value:function(){this.updateGeographicPositions()}},{key:"onGraphAdd",value:function(t){var i;if(t.target.isNode()){var n=t.target;this.originalPositions||(this.originalPositions={}),this.originalPositions[n.id()]=m({},n.position());var o=null===(i=this.cy)||void 0===i?void 0:i.collection().merge(n);this.updateGeographicPositions(o)}}},{key:"onGraphResize",value:function(){var t;null===(t=this.map)||void 0===t||t.invalidateSize(!1)}},{key:"onGraphDragFree",value:function(t){var i,n,o=t.target;if(null!==(i=this.options)&&void 0!==i&&i.setPosition){var e,r=o.position(),a=[r.x,r.y],s=null===(e=this.map)||void 0===e?void 0:e.containerPointToLatLng(a);s&&this.options.setPosition(o,s)}var u=null===(n=this.cy)||void 0===n?void 0:n.collection().merge(o);this.updateGeographicPositions(u)}},{key:"dispatchMapEvent",value:function(t){var i,n;if(!(t.target===this.mapContainer||null!==(i=this.mapContainer)&&void 0!==i&&i.contains(t.target))){var o=new t.constructor(t.type,t);null===(n=this.map)||void 0===n||n.getContainer().dispatchEvent(o)}}},{key:"getNodeLngLat",value:function(t){var i,o;if("function"==typeof(null===(i=this.options)||void 0===i?void 0:i.getPosition)){var e=null===(o=this.options)||void 0===o?void 0:o.getPosition(t);if(e){var r;try{r=n.default.latLng(e)}catch(t){return}return r}}}},{key:"getNodeLngLatBounds",value:function(){var t,i,o=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==t?t:[];return e.reduce((function(t,i){var n=o.getNodeLngLat(i);return n?t.extend(n):t}),n.default.latLngBounds([]))}},{key:"getGeographicPosition",value:function(t){var i,n=this.getNodeLngLat(t);if(n)return null===(i=this.map)||void 0===i?void 0:i.latLngToContainerPoint(n)}}]),t}();function w(t){t&&t("core","L",(function(t,i){return new x(this,t,i)}))}return void 0!==window.cytoscape&&w(window.cytoscape),w}));
//# sourceMappingURL=cytoscape-leaflet.min.js.map
