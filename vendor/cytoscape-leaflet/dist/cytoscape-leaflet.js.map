{"version":3,"file":"cytoscape-leaflet.js","sources":["../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/memoize-one/dist/memoize-one.esm.js","../src/utils.ts","../src/mapHandler.ts","../src/index.ts"],"sourcesContent":["function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var safeIsNaN = Number.isNaN ||\n    function ponyfill(value) {\n        return typeof value === 'number' && value !== value;\n    };\nfunction isEqual(first, second) {\n    if (first === second) {\n        return true;\n    }\n    if (safeIsNaN(first) && safeIsNaN(second)) {\n        return true;\n    }\n    return false;\n}\nfunction areInputsEqual(newInputs, lastInputs) {\n    if (newInputs.length !== lastInputs.length) {\n        return false;\n    }\n    for (var i = 0; i < newInputs.length; i++) {\n        if (!isEqual(newInputs[i], lastInputs[i])) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoizeOne(resultFn, isEqual) {\n    if (isEqual === void 0) { isEqual = areInputsEqual; }\n    var cache = null;\n    function memoized() {\n        var newArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            newArgs[_i] = arguments[_i];\n        }\n        if (cache && cache.lastThis === this && isEqual(newArgs, cache.lastArgs)) {\n            return cache.lastResult;\n        }\n        var lastResult = resultFn.apply(this, newArgs);\n        cache = {\n            lastResult: lastResult,\n            lastArgs: newArgs,\n            lastThis: this,\n        };\n        return lastResult;\n    }\n    memoized.clear = function clear() {\n        cache = null;\n    };\n    return memoized;\n}\n\nexport { memoizeOne as default };\n","import memoizeOne from 'memoize-one';\n\n/**\n * @see https://github.com/cytoscape/cytoscape.js/blob/master/src/extensions/renderer/base/load-listeners.js\n */\nexport function isMultSelKeyDown(event: MouseEvent) {\n  return event.shiftKey || event.metaKey || event.ctrlKey; // maybe event.altKey\n}\n\n/**\n * @param {cytoscape.Position} position1\n * @param {cytoscape.Position} position2\n * @return {boolean}\n */\nfunction arePositionsEqual(\n  position1: cytoscape.Position,\n  position2: cytoscape.Position\n) {\n  return position1.x === position2.x && position1.y === position2.y;\n}\n\nexport function getUpdatedPositions(\n  currentPositions: cytoscape.NodePositionMap,\n  positions: cytoscape.NodePositionMap\n): cytoscape.NodePositionMap {\n  return Object.fromEntries(\n    Object.entries(positions).filter(([id, position]) => {\n      const currentPosition = currentPositions[id];\n      return !arePositionsEqual(currentPosition, position);\n    })\n  );\n}\n\nexport const getUpdatedPositionsMemo = memoizeOne(getUpdatedPositions);\n","import L, { PointTuple } from 'leaflet';\nimport { MapHandlerOptions } from './types';\nimport { getUpdatedPositionsMemo, isMultSelKeyDown } from './utils';\n\nconst DEFAULT_FIT_PADDING: PointTuple = [50, 50];\nconst DEFAULT_ANIMATION_DURATION = 1;\nconst HIDDEN_CLASS = 'cytoscape-map__hidden';\n\nexport class MapHandler {\n  cy: cytoscape.Core | undefined;\n  mapOptions: L.MapOptions;\n  options: MapHandlerOptions | undefined;\n\n  mapContainer: HTMLElement | undefined;\n  map: L.Map | undefined;\n\n  originalAutoungrabify: boolean | undefined;\n  originalUserZoomingEnabled: boolean | undefined;\n  originalUserPanningEnabled: boolean | undefined;\n\n  originalPositions: cytoscape.NodePositionMap | undefined;\n  originalZoom: number | undefined;\n  originalPan: cytoscape.Position | undefined;\n\n  enabled: boolean = false;\n  panning: boolean = false;\n  updateLayout: boolean = true;\n  // zooming: boolean = false;\n\n  requestAnimationId: number | undefined;\n\n  onGraphContainerMouseDownBound = this.onGraphContainerMouseDown.bind(this);\n  onGraphContainerMouseMoveBound = this.onGraphContainerMouseMove.bind(this);\n  onGraphContainerWheelBound = this.onGraphContainerWheel.bind(this);\n  onMapMoveBound = this.onMapMove.bind(this);\n\n  onGraphAddBound = this.onGraphAdd.bind(this);\n  onGraphResizeBound = this.onGraphResize.bind(this);\n  onGraphDragFreeBound = this.onGraphDragFree.bind(this);\n\n  // onZoomStartBound = this.onZoomStart.bind(this);\n  // onZoomEndBound = this.onZoomEnd.bind(this);\n  // panZoomAnimationFrameBound = this.panZoomAnimationFrame.bind(this);\n\n  /**\n   * @param {cytoscape.Core} cy\n   * @param {L.MapOptions} mapOptions\n   * @param {MapHandlerOptions} options\n   */\n  constructor(\n    cy: cytoscape.Core,\n    mapOptions: L.MapOptions,\n    options: MapHandlerOptions\n  ) {\n    this.cy = cy;\n    this.mapOptions = mapOptions;\n    this.options = options;\n\n    this.updateLayout = options.updateLayout || false;\n\n    if (!(typeof this.options.getPosition === 'function')) {\n      throw new Error('getPosition should be a function');\n    }\n    if (\n      this.options.setPosition &&\n      !(typeof this.options.setPosition === 'function')\n    ) {\n      throw new Error('setPosition should be a function');\n    }\n\n    this.enable();\n  }\n\n  enable() {\n    if (!this.cy) return\n    if (!this.options) return\n\n    if (this.enabled) return\n    this.enabled = true;\n\n    // Cytoscape config\n    this.originalAutoungrabify = this.cy.autoungrabify();\n    this.originalUserZoomingEnabled = this.cy.userZoomingEnabled();\n    this.originalUserPanningEnabled = this.cy.userPanningEnabled();\n\n    this.cy.userZoomingEnabled(false);\n    this.cy.userPanningEnabled(false);\n\n    // Cytoscape events\n    const graphContainer = this.cy.container() as unknown as HTMLElement;\n    graphContainer.addEventListener(\n      'mousedown',\n      this.onGraphContainerMouseDownBound\n    );\n    graphContainer.addEventListener(\n      'mousemove',\n      this.onGraphContainerMouseMoveBound\n    );\n    graphContainer.addEventListener('wheel', this.onGraphContainerWheelBound);\n    this.cy.on('add', this.onGraphAddBound);\n    this.cy.on('resize', this.onGraphResizeBound);\n    this.cy.on('dragfree', this.onGraphDragFreeBound);\n\n    // Map container\n    if (!this.mapContainer) {\n      this.mapContainer = document.createElement('div');\n      this.mapContainer.style.position = 'absolute';\n      this.mapContainer.style.top = '0px';\n      this.mapContainer.style.left = '0px';\n      this.mapContainer.style.width = '100%';\n      this.mapContainer.style.height = '100%';\n\n      graphContainer?.prepend(this.mapContainer);\n    }\n\n    // Leaflet instance\n    if (!this.map) {\n      this.map = new L.Map(this.mapContainer, this.mapOptions);\n      this.fit();\n    }\n\n    // Map events\n    this.map.on('move', this.onMapMoveBound);\n    // this.map.on('zoomstart', this.onZoomStartBound);\n    // this.map.on('zoomend', this.onZoomEndBound);\n\n    // Cytoscape unit viewport\n    this.originalZoom = this.cy.zoom();\n    this.originalPan = { ...this.cy.pan() };\n\n    const zoom = 1;\n    const pan = { x: 0, y: 0 };\n\n    if (this.options.animate) {\n      this.cy.animate(\n        {\n          zoom: zoom,\n          pan: pan,\n        },\n        {\n          duration:\n            this.options.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n          easing: 'linear',\n        }\n      );\n    } else {\n      this.cy.viewport({ zoom, pan });\n    }\n\n    // Cytoscape positions\n    this.enableGeographicPositions();\n  }\n\n  destroy() {\n    this.disable();\n\n    // Map instance\n    this.map?.remove();\n    this.map = undefined;\n\n    // Map container\n    this.mapContainer?.remove();\n    this.mapContainer = undefined;\n\n    this.cy = undefined;\n    this.options = undefined;\n  }\n\n  disable() {\n    if (!this.enabled) return\n    this.enabled = false;\n\n    // Cytoscape events\n    const graphContainer = this.cy?.container();\n    if (graphContainer) {\n      graphContainer.removeEventListener(\n        'mousedown',\n        this.onGraphContainerMouseDownBound\n      );\n      graphContainer.removeEventListener(\n        'mousemove',\n        this.onGraphContainerMouseMoveBound\n      );\n      graphContainer.removeEventListener(\n        'wheel',\n        this.onGraphContainerWheelBound\n      );\n    }\n    if (this.cy) {\n      this.cy.off('add', this.onGraphAddBound);\n      this.cy.off('resize', this.onGraphResizeBound);\n      this.cy.off('dragfree', this.onGraphDragFreeBound);\n\n      // Cytoscape config\n      this.cy.autoungrabify(this.originalAutoungrabify);\n      this.cy.userZoomingEnabled(this.originalUserZoomingEnabled);\n      this.cy.userPanningEnabled(this.originalUserPanningEnabled);\n    }\n    this.originalAutoungrabify = undefined;\n    this.originalUserZoomingEnabled = undefined;\n    this.originalUserPanningEnabled = undefined;\n\n    // Map events\n    this.map?.off('move', this.onMapMoveBound);\n\n    // Cytoscape unit viewport\n    if (this.options?.animate) {\n      this.cy?.animate(\n        {\n          zoom: this.originalZoom,\n          pan: this.originalPan,\n        },\n        {\n          duration:\n            this.options.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n          easing: 'linear',\n        }\n      );\n    } else {\n      this.cy?.viewport({\n        zoom: this.originalZoom ?? 5,\n        pan:\n          this.originalPan ??\n          ({\n            x: 0,\n            y: 0,\n          } as cytoscape.Position),\n      });\n    }\n\n    this.originalZoom = undefined;\n    this.originalPan = undefined;\n\n    // Cytoscape positions\n    this.disableGeographicPositions();\n  }\n\n  /**\n   * @param {cytoscape.NodeCollection} nodes\n   * @param {L.FitBoundsOptions} options\n   */\n  fit(\n    nodes: cytoscape.NodeCollection = this.cy?.nodes() ??\n      ([] as unknown as cytoscape.NodeCollection),\n    options: L.FitBoundsOptions = { padding: DEFAULT_FIT_PADDING, animate: false }\n  ) {\n    const bounds = this.getNodeLngLatBounds(nodes);\n    if (!bounds.isValid()) {\n      return;\n    }\n\n    this.map?.fitBounds(bounds, options);\n  }\n\n  /**\n   * @private\n   */\n  private enableGeographicPositions() {\n    if (!this.updateLayout) return;\n\n    const nodes: cytoscape.NodeCollection =\n      this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection);\n\n    this.originalPositions = Object.fromEntries(\n      nodes.map((node) => {\n        return [node.id(), { ...node.position() }];\n      })\n    );\n\n    const positions: cytoscape.NodePositionMap = Object.fromEntries(\n      nodes\n        .map((node) => {\n          return [node.id(), this.getGeographicPosition(node)];\n        })\n        .filter(([_id, position]) => {\n          return !!position;\n        })\n    );\n\n    // hide nodes without position\n    const nodesWithoutPosition = nodes.filter((node) => !positions[node.id()]);\n    nodesWithoutPosition.addClass(HIDDEN_CLASS).style('display', 'none');\n\n    this.cy\n      ?.layout({\n        name: 'preset',\n        positions: positions,\n        fit: false,\n        animate: this.options?.animate,\n        animationDuration:\n          this.options?.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n        animationEasing: 'ease-out-cubic',\n      })\n      .run();\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeCollection | undefined} nodes\n   */\n  private updateGeographicPositions(\n    nodes = this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection)\n  ) {\n    if (!this.updateLayout) return;\n\n    const updatePositions = (\n      nodes = this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection)\n    ) => {\n      const positions: cytoscape.NodePositionMap = Object.fromEntries(\n        nodes\n          .map((node) => {\n            return [node.id(), this.getGeographicPosition(node)];\n          })\n          .filter(([_id, position]) => {\n            return !!position;\n          })\n      );\n\n      // update only positions which have changed, for cytoscape-edgehandles compatibility\n      const currentPositions: cytoscape.NodePositionMap = Object.fromEntries(\n        nodes.map((node) => {\n          return [node.id(), { ...node.position() }];\n        })\n      );\n      const updatedPositions = getUpdatedPositionsMemo(\n        currentPositions,\n        positions\n      );\n\n      // hide nodes without position\n      const nodesWithoutPosition = nodes.filter(\n        (node) => !positions[node.id()]\n      );\n      nodesWithoutPosition.addClass(HIDDEN_CLASS).style('display', 'none');\n\n      // for (const k in updatedPositions) {\n      //   const prev = currentPositions[k];\n      //   const next = updatedPositions[k];\n      //   if (prev && next) {\n      //     this.cy?.getElementById(k)?.position(next);\n      //   }\n      // }\n\n      this.cy\n        ?.layout({\n          name: 'preset',\n          positions: updatedPositions,\n          fit: false,\n        })\n        .run();\n    };\n\n    updatePositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  private disableGeographicPositions() {\n    if (!this.updateLayout) return;\n\n    const nodes =\n      this.cy?.nodes() ?? ([] as unknown as cytoscape.NodeCollection);\n\n    this.cy\n      ?.layout({\n        name: 'preset',\n        positions: this.originalPositions,\n        fit: false,\n        animate: this.options?.animate,\n        animationDuration:\n          this.options?.animationDuration ?? DEFAULT_ANIMATION_DURATION,\n        animationEasing: 'ease-in-cubic',\n        stop: () => {\n          // show nodes without position\n          const nodesWithoutPosition = nodes.filter((node) =>\n            node.hasClass(HIDDEN_CLASS)\n          );\n          nodesWithoutPosition.removeClass(HIDDEN_CLASS).style('display', null);\n        },\n      })\n      .run();\n\n    this.originalPositions = undefined;\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerMouseDown(event: MouseEvent) {\n    // @ts-ignore\n    const renderer = this.cy?.renderer();\n    if (\n      event.buttons === 1 &&\n      !isMultSelKeyDown(event) &&\n      !renderer.hoverData.down\n    ) {\n      // @ts-ignore,\n      if (this.cy) this.cy.renderer().hoverData.dragging = true; // cytoscape-lasso compatibility\n      this.dispatchMapEvent(event);\n\n      document.addEventListener(\n        'mouseup',\n        () => {\n          if (!this.panning) {\n            return;\n          }\n\n          this.panning = false;\n\n          // @ts-ignore, prevent unselecting in Cytoscape mouseup\n          if (this.cy) this.cy.renderer().hoverData.dragged = true;\n        },\n        { once: true }\n      );\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerMouseMove(event: MouseEvent) {\n    // @ts-ignore\n    const renderer = this.cy?.renderer();\n    if (\n      event.buttons === 1 &&\n      !isMultSelKeyDown(event) &&\n      !renderer.hoverData.down\n    ) {\n      this.panning = true;\n\n      this.dispatchMapEvent(event);\n    }\n  }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private onGraphContainerWheel(event: MouseEvent) {\n    event.preventDefault();\n    this.dispatchMapEvent(event);\n  }\n\n  /**\n   * @private\n   */\n  private onMapMove() {\n    this.updateGeographicPositions();\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.EventObject} event\n   */\n  private onGraphAdd(event: cytoscape.EventObject) {\n    if (!event.target.isNode()) {\n      return;\n    }\n\n    const node: cytoscape.NodeSingular = event.target;\n\n    if (!this.originalPositions) this.originalPositions = {};\n    this.originalPositions[node.id()] = { ...node.position() };\n\n    const nodes = this.cy?.collection().merge(node);\n    this.updateGeographicPositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  private onGraphResize() {\n    this.map?.invalidateSize(false);\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.EventObject} event\n   */\n  private onGraphDragFree(event: cytoscape.EventObject) {\n    const node: cytoscape.NodeSingular = event.target;\n\n    if (this.options?.setPosition) {\n      const { x, y } = node.position();\n      const position: PointTuple = [x, y];\n      const lngLat = this.map?.containerPointToLatLng(position);\n      if (lngLat) this.options.setPosition(node, lngLat);\n    }\n\n    const nodes = this.cy?.collection().merge(node);\n    this.updateGeographicPositions(nodes);\n  }\n\n  /**\n   * @private\n   */\n  // private onZoomStart() {\n  //   this.zooming = true;\n  //   this.panZoomAnimationFrame();\n  // }\n\n  /**\n   * @private\n   */\n  // private panZoomAnimationFrame() {\n  //   if (!this.zooming) {\n  //     return window.cancelAnimationFrame(this.requestAnimationId);\n  //   }\n  //   this.updateGeographicPositions()\n  //   this.requestAnimationId = window.requestAnimationFrame(this.panZoomAnimationFrameBound);\n  // }\n\n  /**\n   * @private\n   */\n  // private onZoomEnd() {\n  //   window.cancelAnimationFrame(this.requestAnimationId);\n  //   this.zooming = false;\n  // }\n\n  /**\n   * @private\n   * @param {MouseEvent} event\n   */\n  private dispatchMapEvent(event: MouseEvent) {\n    if (\n      event.target === this.mapContainer ||\n      // @ts-ignore\n      this.mapContainer?.contains(event.target)\n    ) {\n      return;\n    }\n\n    // @ts-ignore\n    const clonedEvent = new event.constructor(event.type, event);\n    this.map?.getContainer().dispatchEvent(clonedEvent);\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeSingular} node\n   * @return {L.LatLng | undefined}\n   */\n  private getNodeLngLat(node: cytoscape.NodeSingular): L.LatLng | undefined {\n    if (typeof this.options?.getPosition !== 'function') return;\n\n    const lngLatLike = this.options?.getPosition(node);\n    if (!lngLatLike) {\n      return;\n    }\n\n    let lngLat;\n    try {\n      lngLat = L.latLng(lngLatLike);\n    } catch (e) {\n      return;\n    }\n\n    return lngLat;\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeCollection} nodes\n   * @return {L.LatLngBounds}\n   */\n  private getNodeLngLatBounds(\n    nodes: cytoscape.NodeCollection = this.cy?.nodes() ??\n      ([] as unknown as cytoscape.NodeCollection)\n  ): L.LatLngBounds {\n    return nodes.reduce((bounds, node) => {\n      const lngLat = this.getNodeLngLat(node);\n      if (!lngLat) {\n        return bounds;\n      }\n\n      return bounds.extend(lngLat);\n    }, L.latLngBounds([]));\n  }\n\n  /**\n   * @private\n   * @param {cytoscape.NodeSingular} node\n   * @return {cytoscape.Position | undefined}\n   */\n  private getGeographicPosition(\n    node: cytoscape.NodeSingular\n  ): cytoscape.Position | undefined {\n    const lngLat = this.getNodeLngLat(node);\n    if (!lngLat) {\n      return;\n    }\n\n    return this.map?.latLngToContainerPoint(lngLat);\n  }\n}\n","import L from 'leaflet';\nimport { MapHandler } from './mapHandler';\nimport { Instance, MapHandlerOptions } from './types';\n\nfunction register(cytoscape: Instance) {\n  if (!cytoscape) {\n    return;\n  }\n\n  cytoscape(\n    'core',\n    'L',\n    function (mapConfig: L.MapOptions, config: MapHandlerOptions) {\n      return new MapHandler(\n        // @ts-ignore\n        this,\n        mapConfig,\n        config\n      );\n    }\n  );\n}\n\nif (typeof window.cytoscape !== 'undefined') {\n  register(window.cytoscape);\n}\n\nexport default register;\n"],"names":["isMultSelKeyDown","event","shiftKey","metaKey","ctrlKey","arePositionsEqual","position1","position2","x","y","getUpdatedPositions","currentPositions","positions","Object","fromEntries","entries","filter","_slicedToArray","id","position","currentPosition","getUpdatedPositionsMemo","memoizeOne","DEFAULT_FIT_PADDING","DEFAULT_ANIMATION_DURATION","HIDDEN_CLASS","MapHandler","cy","mapOptions","options","_classCallCheck","_defineProperty","onGraphContainerMouseDown","bind","onGraphContainerMouseMove","onGraphContainerWheel","onMapMove","onGraphAdd","onGraphResize","onGraphDragFree","updateLayout","getPosition","Error","setPosition","enable","_createClass","enabled","originalAutoungrabify","autoungrabify","originalUserZoomingEnabled","userZoomingEnabled","originalUserPanningEnabled","userPanningEnabled","graphContainer","container","addEventListener","onGraphContainerMouseDownBound","onGraphContainerMouseMoveBound","onGraphContainerWheelBound","on","onGraphAddBound","onGraphResizeBound","onGraphDragFreeBound","mapContainer","document","createElement","style","top","left","width","height","prepend","map","L","Map","fit","onMapMoveBound","originalZoom","zoom","originalPan","pan","animate","duration","animationDuration","easing","viewport","enableGeographicPositions","disable","remove","undefined","removeEventListener","off","disableGeographicPositions","nodes","padding","bounds","getNodeLngLatBounds","isValid","fitBounds","originalPositions","node","getGeographicPosition","nodesWithoutPosition","addClass","layout","name","animationEasing","run","updatePositions","updatedPositions","stop","hasClass","removeClass","renderer","buttons","hoverData","down","dragging","dispatchMapEvent","panning","dragged","once","preventDefault","updateGeographicPositions","target","isNode","collection","merge","invalidateSize","lngLat","containerPointToLatLng","contains","clonedEvent","constructor","type","getContainer","dispatchEvent","lngLatLike","latLng","e","reduce","getNodeLngLat","extend","latLngBounds","latLngToContainerPoint","register","cytoscape","mapConfig","config","window"],"mappings":"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"}